{% extends "base.html" %}

{% block title %}Access Assignments{% endblock %}

{% block content %}
<header>
    <h1>Access Assignments</h1>
    <p>Review current assignments and adjust which instances each admin or viewer can access.</p>
</header>

{% if admins.len() > 0 %}
<div role="list">
    {% for admin in admins %}
    <section role="listitem">
        <h2>{{ admin.username }}</h2>
        <form action="{{ base_url }}/access/{{ admin.username }}" method="post">
            <fieldset>
                <legend>Select instances</legend>
                {% if admin.instances.len() > 0 %}
                <div role="list">
                    {% for row in admin.instances %}
                    <label role="listitem" {% if row.checked %}aria-current="true"{% endif %}>
                        <input type="checkbox" name="instances" value="{{ row.id }}" {% if row.checked %}checked{% endif %}>
                        <span>{{ row.hostname }}</span>
                        <span>ID: {{ row.id }}</span>
                    </label>
                    {% endfor %}
                </div>
                {% else %}
                <p>No instances available from the developer API.</p>
                {% endif %}
            </fieldset>
            <footer>
                <button type="submit">Save assignments</button>
            </footer>
        </form>
    </section>
    {% endfor %}
</div>
{% else %}
<section>
    <p>No admin or viewer users found. Create an admin or viewer account first.</p>
</section>
{% endif %}
{% endblock %}
